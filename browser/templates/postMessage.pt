<div id="post-message" tal:define="startNew options/startNew">
  <!--Post a Message Content Provider-->
  
  <h2 tal:condition="not:startNew">Add to the topic
    <cite class="topic" tal:content="options/topic">topicName</cite>
    <a class="helpLink" title="Help with posting a message" 
      href="/help/manual/#groupserver-posting-a-message-using-the-web">[?]</a></h2>
  
  <div id="post-topic-field" class="formelementtext"
    tal:condition="startNew">
    <label class="text" for="topic">Topic</label>
    <div class="hint">The topic (or subject) of your post.</div>
    <input type="text" name="topic" id="topic" class="text"/>
  </div>

  <div id="post-from-fields" class="formelementtext"
    tal:condition="python:len(options['fromEmailAddresses'])&gt;1">
    <label class="text" for="email">Email from</label>
    <div class="hint">The email address that you wish to send the 
      post from.</div>
    <select id="email" name="email" class="text"
      title="The email address to send the post from.">
      <tal:block tal:repeat="address options/fromEmailAddresses">
        <option tal:condition="python:address!=options['preferredEmailAddress']"
          tal:attributes="value address" tal:content="address"/>
        <option tal:condition="python:address==options['preferredEmailAddress']" 
          selected="selected"
          tal:attributes="value address" tal:content="address"/>
      </tal:block>
    </select>
  </div>
  <p tal:condition="python:len(options['fromEmailAddresses'])==1" >
    <strong>From:</strong>
    <span class="email" 
      tal:content="python:options['fromEmailAddresses'][0]">foo@example.com</span>
    <input type="hidden" name="email" tal:attributes="value python:options['fromEmailAddresses'][0]"/>
  </p>
  
  <div id="message-fields" class="formelementtext">
    <label class="text" for="message">Message</label>
    <div class="hint">The message you wish to post.</div>
    <textarea id="message" name="message" class="text" 
      title="The message you wish to post."></textarea>
  </div>
  
  <fieldset id="post-optional-fields">
    <legend>Optional Fields</legend>
    <div class="formelementtext" id="tags-fields">
      <label class="text" for="tags">Tags
        <a href="/help/manual/#groupserver-tags"
          title="Help with tags"
          class="helpLink">[?]</a></label> 
      <div class="hint">The keywords that summarise your post.</div>
      <input id="tags" name="tags" class="text" type="text" 
        value="" title="The keywords that summarise your post." />
    </div>
    <div class="formelementtext" id="post-file-fields">
      <label class="text" for="file">File
        <a href="/help/manual/#groupserver-posting-files-using-the-web"
          title="Help with posting files"
          class="helpLink">[?]</a></label>
      <div class="hint">The file you wish to post.</div>
      <input id="file" name="file" class="text" type="file" value="" 
        title="The file you wish to post." /> 
    </div>
  </fieldset>
  <div class="formelementbutton">
    <div class="hint" tal:condition="startNew">
      Start the new topic
    </div>
    <div class="hint" tal:condition="not:startNew">
      Add your post to the topic 
      <cite class="topic" tal:content="options/topic">topicName</cite>
    </div>
    <input class="button" type="submit" value="Add" 
      id="addPost" name="addPost" 
      tal:attributes="value python:startNew and 'Start' or 'Add';
      title python:startNew and 'Start the new topic' or 'Add to the topic'"/>
  </div>
</div>
