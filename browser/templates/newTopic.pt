<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<tal:block xmlns:tal="http://xml.zope.org/namespaces/tal"
  tal:define="retval view/update">
<html xmlns="http://www.w3.org/1999/xhtml"
  xmlns:metal="http://xml.zope.org/namespaces/metal"
  xmlns:tal="http://xml.zope.org/namespaces/tal"
  metal:use-macro="context/@@groupserver_layout/page">
  <head>

    <!--Todo: add the division name.-->
  	<title metal:fill-slot="title">
      Start a new topic in
      <span tal:replace="python:view.groupInfo.get_name()"/>:
      <span tal:replace="python:view.siteInfo.get_name()"/>
    </title>
    
    <meta name="title" content="New Topic Template"/>
    <meta name="author" content="Michael JasonSmith" />
    <meta name="description" 
      content="This template is used to render the new topic page" />
    <meta name="date" content="2006-11-14"/>
    
    <tal:block metal:fill-slot="metadata">

      <link rel="up" href="#"
        tal:attributes="title python:view.groupInfo.get_name();
        href python:'%s/groups/%s' % (view.siteInfo.get_url(), view.groupInfo.get_id())"/>
      
      <!-- The documents related to this post -->
      <link rel="bookmark" title="Group Homepage" href="#"
        tal:attributes="title python:'%s Homepage' % view.groupInfo.get_name();
        href python:view.groupInfo.get_url()">&#160;</link>
      <link rel="home" 
        tal:attributes="title python:'%s Homepage' % view.siteInfo.get_name();
        href python:view.siteInfo.get_url()"/>
      <link rel="help" 
        tal:attributes="title python:'%s Help' % view.siteInfo.get_name();
        href python:'%s/help' % view.siteInfo.get_url()"/>
    </tal:block>
   
    <tal:block metal:fill-slot="javascript">
      <!-- Standard GroupServer JavaScript: XForms, Dojo and popup help -->
      <script type="text/javascript" 
        src="/Presentation/Tofu/XForms/js/xforms.js">&#160;</script>
      <script type="text/javascript"
        src="/++resource++prototype/prototype.js">&#160;</script>
      <script type="text/javascript"
          src="/++resource++scriptaculous/scriptaculous.js?load=effects">&#160;</script>
      <script type="text/javascript"
        src="/++resource++post.js">&#160;</script>
    </tal:block>
    
    <tal:block metal:fill-slot="style">
      <link rel="stylesheet" title="Single-Post Stylesheet" type="text/css" 
        href="/++resource++singlePost.css">&#160;</link>
    </tal:block>
  </head>

  <body>
    <!--
      - The error-messages can go in odd places, so define them seperately 
      - from the content. In addition, they can be generated by something 
      - other than the "process_form" method of the view. -->
    <div metal:fill-slot="messages"
      tal:define="result view/retval;
      isError python:result and result.has_key('error') and result['error'];"
      tal:condition="python:result and result.has_key('message')"
      tal:attributes="class python:(isError and 'message-error') or 'message-result'"
      tal:content="structure result/message"/>

    <!-- 
      - The body of the document. Most of the body-content is created 
      - from the messages, grabbed from the XWFVirtualMailingList
      - instance.
    -->
    <tal:block metal:fill-slot="body">
      <form method="get" action="/search_all.xml"
        enctype="application/x-www-form-urlencoded">
        <!-- Site Search -->
        <div id="searcharea">
          <h3>Site Search</h3>
          <input type="text" class="text" name="query"/>
          <input type="submit" name="" value="Go" class="button"/>
        </div>
      </form>
      
      <h1>Start a New Topic</h1>
      <div id="posting" 
        tal:define="canPost python:view.get_user_can_post(True)">
        <form method="post" action=""
          enctype="multipart/form-data"
          tal:condition="python:canPost[1]"
          tal:define="startNew python:True"
          tal:attributes="action request/URL">
      
          <p 
            tal:define="pageTemplateFileName string:browser/templates/postMessageData.pt"
            tal:replace="structure provider:groupserver.PostMessage">
            The space for the hidden metadata associated with the new post.
          </p>
          <p tal:replace="structure provider:groupserver.PostMessage">
            The space to allow people to write the new post.
          </p>
        </form><!-- Posting Form -->
        <div tal:condition="python: not canPost[1]">
          <p tal:content="python:canPost[0][0]"/>
        </div>
      </div><!--posting-->
    </tal:block>
  </body>
</html>
</tal:block>
